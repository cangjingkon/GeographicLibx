=for comment $Id$

=head1 NAME

Geod -- perform geodesic calculations

=head1 SYNOPSIS

B<Geod> [ B<-i> | B<-l> I<lat1> I<lon1> I<azi1> ] [ B<-a> ] [ B<-e> I<a> I<f> ]
[ B<-d> ] [ B<-b> ] [ B<-f> ] [ B<-p> I<prec> ]
[ B<--version> | B<-h> | B<--help> ]
[ B<--input-file> I<infile> | B<--input-string> I<instring> ]
[ B<--output-file> I<outfile> ]

=head1 DESCRIPTION

The shortest path between two points on the ellipsoid at (I<lat1>,
I<lon1>) and (I<lat2>, I<lon2>) is called the geodesic.  Its length is
I<s12> and the geodesic from point 1 to point 2 has azimuths I<azi1> and
I<azi2> at the two end points.

B<Geod> operates in one of three modes:

=over

=item 1.

By default, B<Geod> accepts lines on the standard input containing
I<lat1> I<lon1> I<azi1> I<s12> and prints I<lat2> I<lon2> I<azi2>
on standard output.  This is the direct geodesic calculation.

=item 2.

Command line arguments B<-l> I<lat1> I<lon1> I<azi1> specify a geodesic line.
B<Geod> then accepts a sequence of I<s12> values (one per line) on
standard input and prints I<lat2> I<lon2> I<azi2> for each.  This
generates a sequence of points on a single geodesic.

=item 3.

With the B<-i> command line argument, B<Geod> performs the inverse
geodesic calculation.  It reads lines containing I<lat1> I<lon1> I<lat2>
I<lon2> and prints the corresponding values of I<azi1> I<azi2> I<s12>.

=back

=head1 OPTIONS

=over

=item B<-i>

perform an inverse geodesic calculation (see 3 above).

=item B<-l>

line mode (see 2 above); generate a sequence of points along the
geodesic specified by I<lat1> I<lon1> I<azi1>.

=item B<-a>

arc mode; on input I<and> output I<s12> is replaced by I<a12> the arc
length (in degrees) on the auxiliary sphere.  See L<AUXILIARY SPHERE>.

=item B<-e>

specify the ellipsoid via I<a> I<f>; the equatorial radius is I<a> and
the flattening is I<f>.  Setting I<f> = 0 results in a sphere.  Specify
I<f> E<lt> 0 for a prolate ellipsoid.  A simple fraction, e.g., 1/297,
is allowed for I<f>.  (Also, if I<f> E<gt> 1, the flattening is set to
1/I<f>.)  By default, the WGS84 ellipsoid is used, I<a> = 6378137 m,
I<f> = 1/298.257223563.

=item B<-d>

output angles as degrees, minutes, seconds instead of decimal degrees.

=item B<-b>

report the I<back> azimuth at point 2 instead of the forward azimuth.

=item B<-f>

full output; each line of output consists of 12 quantities: I<lat1>
I<lon1> I<azi1> I<lat2> I<lon2> I<azi2> I<s12> I<a12> I<m12> I<M12>
I<M21> I<S12>.  I<a12> is described in L<AUXILIARY SPHERE>.  The four
quantities I<m12>, I<M12>, I<M21>, and I<S12> are described in
L<ADDITIONAL QUANTITIES>.

=item B<-p>

set the precision to I<prec> (default 3); I<prec> is the precision
relative to 1 m.  See L<PRECISION|precision>.

=item B<--version>

print version and exit.

=item B<-h>

print usage and exit.

=item B<--help>

print full documentation and exit.

=item B<--input-file>

read input from the file I<infile> instead of from standard input; a file
name of "-" stands for standard input.

=item B<--input-string>

read input from the string I<instring> instead of from standard input.
All the semicolons in I<instring> are converted to newlines before the
reading begins.

=item B<--output-file>

write output to the file I<outfile> instead of to standard output; a
file name of "-" stands for standard output.

=back

=head1 INPUT

B<Geod> measures all angles in degrees and all lengths (I<s12>) in
meters.  On input angles (latitude, longitude, azimuth, arc length) can
be as decimal degrees or degrees (d), minutes ('), seconds (").  A
decimal point can only appear in the least significant component and the
designator (d, ', or ") for this component is optional; thus C<40d30>,
C<40d30'>, C<40.5d>, and C<40.5> are all equivalent.  By default,
latitude precedes longitude for each point; however on input either may
be given first by appending (or prepending) I<N> or I<S> to the latitude
and I<E> or I<W> to the longitude.  Azimuths are measured clockwise from
north; however this may be overridden with I<E> or I<W>.

=head1 AUXILIARY SPHERE

Geodesics on the ellipsoid can be transferred to the I<auxiliary sphere>
on which the distance is measured in terms of the arc length I<a12>
(measured in degrees) instead of I<s12>.  In terms of I<a12>, 180
degrees is the distance from one equator crossing to the next or from
the minimum latitude to the maximum latitude.  Geodesics with I<a12>
E<gt> 180 degrees do not correspond to shortest paths.  With the B<-a>
flag, I<s12> (on both input and output) is replaced by I<a12>.  The
B<-a> flag does I<not> affect the full output given by the B<-f> flag
(which always includes both I<s12> and I<a12>).

=head1 ADDITIONAL QUANTITIES

The B<-f> flag reports four addtional quantities.

The reduced length of the geodesic, I<m12>, is defined such that if the
initial azimuth is perturbed by dI<azi1> (radians) then the second point
is displaced by I<m12> dI<azi1> in the direction perpendicular to the
geodesic.  I<m12> is given in meters.  On a curved surface the
reduced length obeys a symmetry relation, I<m12> + I<m21> = 0.  On a
flat surface, we have I<m12> = I<s12>.

I<M12> and I<M21> are geodesic scales.  If two geodesics are parallel at
point 1 and separated by a small distance I<dt>, then they are separated
by a distance I<M12> I<dt> at point 2.  I<M21> is defined similarly
(with the geodesics being parallel to one another at point 2).  I<M12>
and I<M21> are dimensionless quantities.  On a flat surface, we have
I<M12> = I<M21> = 1.

If points 1, 2, and 3 lie on a single geodesic, then the following
addition rules hold,
I<m13> = I<m12> I<M23> + I<m23> I<M21>,
I<M13> = I<M12> I<M23> - (1 - I<M12> I<M21>) I<m23> / I<m12>, and
I<M31> = I<M32> I<M21> - (1 - I<M23> I<M32>) I<m12> / I<m23>.

Finally, I<S12> is the area between the geodesic from point 1 to point 2
and the equator; i.e., it is the area, measured counter-clockwise, of
the quadrilateral with corners (I<lat1>,I<lon1>), (0,I<lon1>),
(0,I<lon2>), and (I<lat2>,I<lon2>).  It is given in meters^2.

=head1 PRECISION

I<prec> gives precision of the output with I<prec> = 0 giving 1 m
precision, I<prec> = 3 giving 1 mm precision, etc.  I<prec> is the
number of digits after the decimal point for lengths.  For decimal
degrees, the number of digits after the decimal point is 5 + I<prec>.
For DMS (degree, minute, seconds) output, the number of digits after the
decimal point in the seconds component is 1 + I<prec>.  The minimum
value of I<prec> is 0 and the maximum is 10.

=head1 ERRORS

An illegal line of input will print an error message to standard output
beginning with C<ERROR:> and causes B<Geod> to return an exit code of 1.
However, an error does not cause B<Geod> to terminate; following lines
will be converted.

=head1 EXAMPLES

Route from JFK Airport to Singapore Changi Airport:

   echo "40d38'23N" "073d46'44W" "01d21'33N" "103d59'22E" |
   Geod -i -d -p 0

   003d18'29.9" 177d29'09.2" 15347628 4302458

Waypoints on the route at intervals of 2000km:

   for ((i = 0; i <= 16; i += 2)); do echo ${i}000000;done |
   Geod -l "40d38'23N" "073d46'44W" "003d18'29.9" -d -p 0

   40d38'23.0"N 073d46'44.0"W 003d18'29.9" 0
   58d34'45.1"N 071d49'36.7"W 004d48'48.8" 1967419
   76d22'28.4"N 065d32'17.8"W 010d41'38.4" 3743642
   84d50'28.0"N 075d04'39.2"E 150d55'00.9" 5156905
   67d26'20.3"N 098d00'51.2"E 173d27'20.3" 6070415
   49d33'03.2"N 101d06'52.6"E 176d07'54.3" 6394568
   31d34'16.5"N 102d30'46.3"E 177d03'08.4" 6095725
   13d31'56.0"N 103d26'50.7"E 177d24'55.0" 5200700
   04d32'05.7"S 104d14'48.7"E 177d28'43.6" 3795596

=head1 SEE ALSO

The algorithms are described in C. F. F. Karney, I<Geodesics on an
ellipsoid of revolution>, Feb. 2011; preprint
L<http://arxiv.org/abs/1102.1215>.  See also C. F. F. Karney,
I<Algorithms for geodesics>, Sept. 2011; preprint
L<http://arxiv.org/abs/1109.4448>.

=head1 AUTHOR

B<Geod> was written by Charles Karney.

=head1 HISTORY

B<Geod> was added to GeographicLib, L<http://geographiclib.sf.net>, in
2009-03.
